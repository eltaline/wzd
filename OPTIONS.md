<img src="/images/logo.png" alt="wZD Logo"/>

Параметры wZD:
========

Секция [command line]
------------

- -config string
        --config=/etc/wzd/wzd.conf (default is "/etc/wzd/wzd.conf")
- -debug 
        --debug - debug mode
- -help 
        --help - displays help
- -version 
        --version - print version

Секция [global]
------------

bindaddr
- **Description**: This is the primary address and TCP port. The value is ": 9699" for all addresses.
- **Default:** "127.0.0.1:9699"
- **Type:** string
- **Section:** [global]

readtimeout
- **Description:** задает таймаут на максимальное время передачи данных от клиента серверу. Для передачи больших файлов следует увеличить. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут установив его в 0. Не настраивается для виртуального хоста
- **Default:** 60
- **Values:** 0-86400
- **Type:** int
- **Section:** [global]

readheadertimeout
- **Description:** задает таймаут на максимальное время получения заголовков от клиента. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут установив его в 0. Если параметр = 0, тогда берется значение параметра readtimeout, если и readtimeout = 0, тогда readheadertimeout таймаут не используется (без таймаута). Не настраивается для виртуального хоста
- **Default:** 5
- **Values:** 0-86400
- **Type:** int
- **Section:** [global]

idletimeout
- **Description:** задает таймаут на максимальное время жизни keep alive соединений. Если параметр = 0, тогда берется значение параметра readtimeout, если и readtimeout = 0, тогда idletimeout таймаут не используется (без таймаута). Не настраивается для виртуального хоста
- **Default:** 60
- **Values:** 0-86400
- **Type:** int
- **Section:** [global]

writetimeout
- **Description:** задает таймаут на максимальное время передачи данных клиенту. Для передачи больших файлов следует значительно увеличить. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут установив его в 0 (без таймаута). Не настраивается для виртуального хоста
- **Default:** 60
- **Values:** 0-86400
- **Type:** int
- **Section:** [global]

realheader
- **Description:** заголовок реального IP адреса от реверс прокси. Не настраивается для виртуального хоста
- **Default:** "X-Real-IP"
- **Type:** string
- **Section:** [global]
       
charset
- **Description:** кодировка на весь сервер. Не настраивается для виртуального хоста
- **Default:** "UTF-8"
- **Type:** string
- **Section:** [global]

debugmode
- **Description:** режим отладки
- **Default:** false
- **Values:** true or false
- **Type:** boolean
- **Section:** [global]

pidfile
- **Description:** путь к pid файлу
- **Default:** "/run/wzd/wzd.pid"
- **Type:** string
- **Section:** [global]

logdir
- **Description:** путь к log директории
- **Default:** "/var/log/wzd"
- **Type:** string
- **Section:** [global]

logmode
- **Description:** права на log файлы (маска)
- **Default:** 0640
- **Values:** 0600-0666
- **Type:** uint32
- **Section:** [global]

defsleep
- **Description:** sleep между попытками открытия bolt архивов (секунды)
- **Default:** 1
- **Values:** 1-5
- **Type:** int
- **Section:** [global]

cmpsched = true
- **Description:** глобальное включение или отключение автоматического диспетчера компакции bolt архивов 
- **Default:** false
- **Values:** true or false
- **Type:** boolean
- **Section:** [global]

cmpdir
- **Description:** директория технической базы данных. Технических данных мало, если не перезаписывать или удалять десятки миллионов файлов в Bolt архивах при включенном диспетчере компакции
- **Default:** /var/lib/wzd
- **Type:** string
- **Section:** [global]

cmptime = 30 
- **Description:** время ожидания компакции обновленных bolt архивов (дни)
- **Default:** 30
- **Values:** 1-1000
- **Type:** int
- **Section:** [global]

cmpcheck = 5
- **Description:** интервал запуска автоматического диспетчера компакции (секунды)
- **Default:** 5
- **Values:** 1-5
- **Type:** int
- **Section:** [global]

Секция [server] и подсекции [server.name]
------------

[server.name]
- **Description:** основной внутренний идентификатор виртуального хоста. после "." можно использовать любое имя, это не доменное имя, только внутренний идентификатор
- **Type:** string
- **Section:** [server]

host
- **Description:** имя виртуального хоста. Не поддерживается * или _ , для сведения множества виртуальных хостов на 1 виртуальный хост в wZD сервере используйте Nginx или HAProxy или любой другой реверс прокси сервер с жестко заданным proxy_set_header Host hostname; (на примере Nginx), где hostname = host в виртуальном хосте wZD сервера
- **Default:** обязательный параметр
- **Type:** string
- **Section:** [server.name]

root
- **Description:** корневая директория виртуального хоста
- **Default:** обязательный параметр
- **Type:** string
- **Section:** [server.name]

upload
- **Description:** включает или отключает метод PUT для виртуального хоста
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

delete
- **Description:** включает или отключает метод DELETE для виртуального хоста
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

compaction
- **Description:** включает или отключает автоматическое добавление задач для диспетчера компакции bolt архивов, при обновлении или удалении, файлов или значений в bolt архивах, если cmpsched не отключен глобально
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

writeintegrity
- **Description:** включает или отключает подсчет и запись контрольной суммы в бинарный заголовок во время загрузки файлов или значений через wZD сервер в bolt архивы. Рекомендуется включить
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

readintegrity
- **Description:** включает или отключает проверку контрольной суммы из бинарного заголовка во время выдачи файлов или значений клиенту сервера. Рекомендуется включить
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

trytimes
- **Description:** количество попыток получения виртуальной блокировки bolt архива, прежде чем выдать http ошибку (количество)
- **Default:** обязательный параметр
- **Values:** 1-1000
- **Type:** int
- **Section:** [server.name]

opentries
- **Description:** количество попыток открытия bolt архива, прежде чем выдать http ошибку (количество)
- **Default:** обязательный параметр
- **Values:** 1-1000
- **Type:** int
- **Section:** [server.name]

fmaxsize
- **Description:** максимальный размер загружаемого файла или значения в bolt архив. Если данный параметр превышен, то файл или значение загрузится как отдельный файл по тому же пути. Рекомендуемый размер не более 1048576 (1МБ). Не рекомендуется загружать файлы или значения в bolt архивы размером больше 32МБ. Такие файлы или значения должны сохраняться отдельно (байты)
- **Default:** обязательный параметр
- **Values:** 1-33554432
- **Type:** int64
- **Section:** [server.name]

args
- **Description:** если отключено, тогда query аргументы будут запрещены для GET запросов. Рекомендуется включить, если вы используете Vary заголовки на реверс прокси сервере или версионность через query аргументы
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

getbolt
- **Description:** если отключено, тогда будет запрещено скачивать напрямую bolt архивы
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

getcount
- **Description:** если отключено, тогда будет запрещено получать суммарное количество файлов или значений (в том числе отдельных файлов) в директории
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

getkeys
- **Description:** если отключено, тогда будет запрещено получать имена файлов или ключей (в том числе отдельных файлов) в директории
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

nonunique
- **Description:** если включено, тогда будет возможно загрузить файл с не уникальным именем в директорию, где уже есть bolt архив, и в этом bolt архиве есть файл или значение с тем же именем ключа, что и загружаемый отдельный файл. В случае если этот параметр выключен, то обратное все равно возможно, то есть возможно загрузить файл или значение именно в bolt архив, даже если уже есть отдельный файл в той же директории с тем же именем, что и имя ключа, загружаемого в bolt архив файла или значения
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]  

cctrl
- **Description:** устанавливает заголовок Cache-Control
- **Default:** обязательный параметр
- **Values:** 0-2147483647
- **Type:** int
- **Section:** [server.name]

buffers options
- **Description:** параметры буферов чтения и записи. Все буферы могут увеличены в несколько раз для сетей с 10-100 Gbit пропускной способностью. Каждый следующий буфер не может быть меньше или равен предыдущему. Требуется увеличивать при условии, что у вас действительно есть большие файлы. В данном примере установлены минимально возможные значения у всех буферов, кроме minbuffer, его минимально возможное значение равно 4096 байт. Для большиства задач, параметров по умолчанию вполне достаточно
- **Default:** обязательный параметр 
- **Type:** int
- **Section:** [global]

- minbuffer = 262144 # минимальный буфер памяти, при не превышении данного значения используется буфер еще более меньший 
- lowbuffer = 1048576 # малый буфер памяти, при превышении данного значения используется минимальный буфер памяти
- medbuffer = 67108864 # средний буфер памяти, при превышении данного значения используется малый буфер памяти
- bigbuffer = 536870912 # не совсем буфер памяти, при превышении данного значения используется средний буфер памяти

filemode
- **Description:** права создания bolt архивов, файлов и виртуальных атрибутов в бинарном заголовке внутри значения в bolt архивах 
- **Default:** обязательный параметр
- **Values:** 0600-0666
- **Type:** uint32
- **Section:** [server.name]

dirmode
- **Description:** права создания директорий 
- **Default:** обязательный параметр
- **Values:** 0700-0777
- **Type:** uint32
- **Section:** [server.name]

delbolt
- **Description:** если включено, тогда будет разрешено удалять напрямую bolt архивы
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

deldir
- **Description:** если включено, тогда wZD сервер будет удалять последнюю пустую директорию, при условии, что реально отсутствуют файлы, поддиректории и количество ключей в bolt архиве = 0. Но удаляется только текущая директория, рекурсивного обхода не реализовано в целях безопасности
- **Default:** обязательный параметр
- **Values:** true or false
- **Type:** boolean
- **Section:** [server.name]

Параметры wZA:
========

Секция [command line]
------------

- -bfilemode string
        --bfilemode=0640 - (0600-0666) права на bolt архивы при упаковке с uid и gid от текущего пользователя и группы (по умолчанию 0640)
- -delete
        --delete - включает режим удаления оригинальных регулярных файлов (с --pack) после упаковки или оригинальных bolt архивов (с --unpack) после распаковки
- -disablecompaction
        --disablecompaction - отключает отложенную компакцию bolt архивов после упаковки (с --overwrite)
- -disablereadintegrity
        --disablereadintegrity - отключает чтение контрольных сумм CRC из бинарного заголовка для регулярных файлов в bolt архивах
- -disablewriteintegrity
        --disablewriteintegrity - отключает запись контрольных сумм CRC в бинарный заголовок для регулярных файлов в bolt архивах
- -fmaxsize int
        --fmaxsize=1048576 - максимально допустимый размер регулярного файла для записи в bolt архивы, в противном случае пропускает файл, максимальное значение: 33554432 байта (по умолчанию 1048576)
- -help
        --help - выводит помощь
- -ignore
        --ignore - включает режим игнорирования всех ошибок при выполнении режима массовой упаковки/распаковки из списка (если потоков > 1, тогда режим игнорирования всегда включен для продолжения выполнения рабочих потоков)
- -ignore-not
        --ignore-not - включает режим игнорирования только тех файлов, которые не существуют или к которым в доступе отказано, действует при работе в режиме массовой упаковки или распаковки по списку
- -list string
        --list=/path/to/list.txt - список файлов или bolt архивов
- -locktimeout int
        locktimeout=60 - максимальный таймаут для открытия bolt архива за 1 попытку, максимальное значение: 3600 (по умолчанию 60)
- -overwrite
        --overwrite - включает режим перезаписи регулярных файлов или файлов в bolt архивах при упаковке или распаковке
- -pack
        --pack - включает режим упаковки регулярных файлов из списка (с --list) или одиночного регулярного файла (с --single=) в bolt архивы
- -progress
        --progress - включает режим индикатора выполнения (несовместим с --verbose)
- -single string
        --single=/path/to/file - упаковать или распаковать один регулярный файл (с --pack) или bolt архив (с --unpack)
- - show string
        --show=/path/to/file.bolt - показывает регулярные файлы/значения в bolt архиве
- -threads int
        --threads=1 - параллельная массовая упаковка или распаковка (компакция (с --overwrite) однопоточная, для безопасности), максимальное значение: 256 (по умолчанию 1)
- -tmpdir string
        --tmpdir=/tmp/wza - временная директория для разделения списка файлов между потоками
- -trytimes int
        trytimes=5 - количество попыток взять виртуальную блокировку для bolt архива (по умолчанию sleep = 1 между попытками), максимальное значение: 1000 (по умолчанию 5)
- -opentries int
        opentries=5 максимальное количество попыток открытия bolt архива (по умолчанию sleep = 1 между попытками), максимальное значение: 1000 (по умолчанию 5)
- -unpack
        --unpack - включает режим распаковки bolt архивов из списка (--list=) или одиночного bolt архива (с --single=) в регулярные файлы
- -verbose
        --verbose - включает подробный режим (несовместим с --progress)
- -version
        --version - выводит версию
