<img src="/images/logo.png" alt="wZD Logo"/>

Параметры wZD:
========

Секция [command line]
------------

- -config string
        --config=/etc/wzd/wzd.conf (по умолчанию "/etc/wzd/wzd.conf")
- -debug 
        --debug - Режим отладки.
- -help 
        --help - Выводит помощь.
- -version 
        --version - Выводит версию.

Секция [global]
------------

bindaddr
- **Описание:** Основной адрес и TCP порт, значение ":9699" все адреса.
- **Умолчание:** "127.0.0.1:9699"
- **Тип:** string
- **Секция:** [global]

bindaddrssl
- **Описание:** Основной SSL адрес и TCP порт, значение ":9799" все адреса.
- **Умолчание:** "127.0.0.1:9799"
- **Тип:** string
- **Секция:** [global]

onlyssl
- **Описание:** Глобальное отключение для всех виртуальных хостов обычного HTTP адреса и порта. Не настраивается для виртуального хоста.
- **Умолчание:** false
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [global]

readtimeout
- **Описание:** Задает таймаут на максимальное время передачи данных от клиента серверу. Для передачи больших файлов следует увеличить. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут, установив его в 0 (без таймаута). Не настраивается для виртуального хоста.
- **Умолчание:** 60
- **Значения:** 0-86400
- **Тип:** int
- **Секция:** [global]

readheadertimeout
- **Описание:** Задает таймаут на максимальное время получения заголовков от клиента. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут, установив его в 0. Если параметр = 0, тогда берется значение параметра readtimeout, если и readtimeout = 0, тогда readheadertimeout таймаут не используется (без таймаута). Не настраивается для виртуального хоста.
- **Умолчание:** 5
- **Значения:** 0-86400
- **Тип:** int
- **Секция:** [global]

writetimeout
- **Описание:** Задает таймаут на максимальное время передачи данных клиенту. Для передачи больших файлов следует значительно увеличить. Если wZD сервер установлен за Nginx или HAProxy, тогда можно не использовать данный таймаут установив его в 0 (без таймаута). Не настраивается для виртуального хоста.
- **Умолчание:** 60
- **Значения:** 0-86400
- **Тип:** int
- **Секция:** [global]

idletimeout
- **Описание:** Задает таймаут на максимальное время жизни keep alive соединений. Если параметр = 0, тогда берется значение параметра readtimeout, если и readtimeout = 0, тогда idletimeout таймаут не используется (без таймаута). Не настраивается для виртуального хоста.
- **Умолчание:** 60
- **Значения:** 0-86400
- **Тип:** int
- **Секция:** [global]

keepalive
- **Описание:** Глобальное включение или отключение keep alive. Не настраивается для виртуального хоста.
- **Умолчание:** false
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [global]

realheader
- **Описание:** Заголовок реального IP адреса от реверс прокси. Не настраивается для виртуального хоста.
- **Умолчание:** "X-Real-IP"
- **Тип:** string
- **Секция:** [global]
       
charset
- **Описание:** Кодировка на весь сервер. Не настраивается для виртуального хоста.
- **Умолчание:** "UTF-8"
- **Тип:** string
- **Секция:** [global]

debugmode
- **Описание:** Режим отладки. Не настраивается для виртуального хоста.
- **Умолчание:** false
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [global]

freelist
- **Описание:** Глобально задает тип алгоритма высвобождения страниц в BoltDB. Алгоритм hashmap более быстрый. Не настраивается для виртуального хоста.
- **Умолчание:** hashmap
- **Значения:** hashmap или array
- **Тип:** string
- **Секция:** [global]

pidfile
- **Описание:** Путь к pid файлу.
- **Умолчание:** "/run/wzd/wzd.pid"
- **Тип:** string
- **Секция:** [global]

logdir
- **Описание:** Путь к log директории.
- **Умолчание:** "/var/log/wzd"
- **Тип:** string
- **Секция:** [global]

logmode
- **Описание:** Права на log файлы (маска).
- **Умолчание:** 0640
- **Значения:** 0600-0666
- **Тип:** uint32
- **Секция:** [global]

defsleep
- **Описание:** Пауза между попытками открытия Bolt архива (секунды).
- **Умолчание:** 1
- **Значения:** 1-5
- **Тип:** int
- **Секция:** [global]

cmpsched = true
- **Описание:** Глобальное включение или отключение автоматического диспетчера компакции/дефрагментации Bolt архивов.
- **Умолчание:** false
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [global]

cmpdir
- **Описание:** Директория технической базы данных. Технических данных мало, используется для диспетчера компакции/дефрагментации.
- **Умолчание:** /var/lib/wzd
- **Тип:** string
- **Секция:** [global]

cmptime = 30 
- **Описание:** Время ожидания компакции/дефрагментации обновленных Bolt архивов (дни).
- **Умолчание:** 30
- **Значения:** 1-1000
- **Тип:** int
- **Секция:** [global]

cmpcheck = 5
- **Описание:** Интервал запуска автоматического диспетчера компакции/дефрагментации (секунды).
- **Умолчание:** 5
- **Значения:** 1-5
- **Тип:** int
- **Секция:** [global]

Секция [server] и подсекции [server.name]
------------

[server.name]
- **Описание:** Основной внутренний идентификатор виртуального хоста. после "." можно использовать любое имя, это не доменное имя, только внутренний идентификатор.
- **Тип:** string
- **Секция:** [server]

host
- **Описание:** Имя виртуального хоста. Не поддерживается * или _ , для сведения множества виртуальных хостов на 1 виртуальный хост в wZD сервере используйте Nginx или HAProxy или любой другой реверс прокси сервер с жестко заданным "proxy_set_header Host hostname;" (на примере Nginx), где hostname = host в виртуальном хосте wZD сервера.
- **Умолчание:** Обязательный параметр
- **Тип:** string
- **Секция:** [server.name]

root
- **Описание:** Корневая директория виртуального хоста.
- **Умолчание:** Обязательный параметр
- **Тип:** string
- **Секция:** [server.name]

sslcrt
- **Описание:** Путь к файлу SSL сертификата для виртуального хоста.
- **Умолчание:** ""
- **Тип:** string
- **Секция:** [server.name]

sslkey
- **Описание:** Путь к файлу SSL ключа для виртуального хоста.
- **Умолчание:** ""
- **Тип:** string
- **Секция:** [server.name]

getallow
- **Описание:** Путь к файлу разрешенных IP адресов методов GET/HEAD/OPTIONS для виртуального хоста. Если файл не указан, всегда будет отдаваться 403 ошибка.
- **Умолчание:** ""
- **Тип:** string
- **Секция:** [server.name]

putallow
- **Описание:** Путь к файлу разрешенных IP адресов для методов PUT/POST/PATCH для виртуального хоста. Если файл не указан, всегда будет отдаваться 403 ошибка.
- **Умолчание:** ""
- **Тип:** string
- **Секция:** [server.name]

delallow
- **Описание:** Путь к файлу разрешенных IP адресов для метода DELETE для виртуального хоста. Если файл не указан, всегда будет отдаваться 403 ошибка.
- **Умолчание:** ""
- **Тип:** string
- **Секция:** [server.name]

options
- **Описание:** Задает заголовок Access-Control-Allow-Methods с доступными методами для виртуального хоста.
- **Умолчание:** "GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE"
- **Тип:** string
- **Секция:** [server.name]

headorigin
- **Описание:** Задает заголовок Access-Control-Allow-Origin.
- **Умолчание:** "*"
- **Тип:** string
- **Секция:** [server.name]

xframe
- **Описание:** Задает заголовок X-Frame-Options.
- **Умолчание:** "sameorigin"
- **Тип:** string
- **Секция:** [server.name]

upload
- **Описание:** Включает или отключает метод PUT для виртуального хоста.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

delete
- **Описание:** Включает или отключает метод DELETE для виртуального хоста.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

compaction
- **Описание:** Включает или отключает автоматическое добавление задач для диспетчера компакции/дефрагментации Bolt архивов, при обновлении или удалении файлов, или значений в Bolt архивах, если параметр cmpsched не отключен глобально.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

writeintegrity
- **Описание:** Включает или отключает подсчет и запись контрольной суммы в бинарный заголовок во время загрузки файлов или значений через wZD сервер в Bolt архивы. Рекомендуется включить.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

readintegrity
- **Описание:** Включает или отключает проверку контрольной суммы из бинарного заголовка во время выдачи файлов или значений клиенту сервера. Рекомендуется включить.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

trytimes
- **Описание:** Количество попыток получения виртуальной блокировки Bolt архива, прежде чем выдать http ошибку (количество).
- **Умолчание:** Обязательный параметр
- **Значения:** 1-1000
- **Тип:** int
- **Секция:** [server.name]

opentries
- **Описание:** Количество попыток открытия Bolt архива, прежде чем выдать http ошибку (количество).
- **Умолчание:** Обязательный параметр
- **Значения:** 1-1000
- **Тип:** int
- **Секция:** [server.name]

fmaxsize
- **Описание:** Максимальный размер загружаемого файла или значения в Bolt архив. Если данный параметр превышен, то файл или значение загрузится как отдельный файл по тому же пути. Рекомендуемый размер не более 1048576 (1МБ). Не рекомендуется загружать файлы или значения в Bolt архивы размером больше 16МБ. Такие файлы или значения должны сохраняться отдельно (байты).
- **Умолчание:** Обязательный параметр
- **Значения:** 1-33554432
- **Тип:** int64
- **Секция:** [server.name]

args
- **Описание:** Если отключено, тогда query аргументы будут запрещены для GET запросов. Рекомендуется включить, если вы используете Vary заголовок на реверс прокси сервере или версионность через query аргументы.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

getbolt
- **Описание:** Если отключено, тогда будет запрещено напрямую скачивать Bolt архивы.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

getkeys
- **Описание:** Если отключено, тогда будет запрещено получать имена файлов или ключей (в том числе отдельных файлов) в директории.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

getinfo
- **Описание:** Если отключено, тогда будет запрещено получать имена файлов или ключей c дополнительной информацией (в том числе отдельных файлов) в директории.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

getcount
- **Описание:** Если отключено, тогда будет запрещено получать суммарное количество файлов или значений (в том числе отдельных файлов) в директории.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

nonunique
- **Описание:** Если включено, тогда будет возможно загрузить файл с не уникальным именем в директорию, где уже есть Bolt архив, и в этом Bolt архиве есть файл или значение с тем же именем ключа, что и загружаемый отдельный файл. В случае если этот параметр выключен, то обратное все равно возможно, то есть возможно загрузить файл или значение именно в Bolt архив, даже если уже есть отдельный файл в той же директории с тем же именем, что и имя ключа, загружаемого в Bolt архив файла или значения.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]  

cctrl
- **Описание:** Устанавливает заголовок Cache-Control.
- **Умолчание:** Обязательный параметр
- **Значения:** 0-2147483647
- **Тип:** int
- **Секция:** [server.name]

buffers options
- **Описание:** Параметры буферов чтения и записи. Все буферы могут увеличены в несколько раз для сетей с 10-100 Gbit пропускной способностью. Каждый следующий буфер не может быть меньше или равен предыдущему буферу. Требуется увеличивать при условии, что у вас действительно есть большие файлы. В данном примере установлены минимально возможные значения у всех буферов, кроме minbuffer, его минимально возможное значение равно 4096 байт. Для большинства задач, параметров по умолчанию вполне достаточно.
- **Умолчание:** Обязательный параметр 
- **Тип:** int
- **Секция:** [global]

- minbuffer = 262144 # минимальный буфер памяти, при не превышении данного значения используется буфер еще меньший.
- lowbuffer = 1048576 # малый буфер памяти, при превышении данного значения используется minbuffer буфер памяти.
- medbuffer = 67108864 # средний буфер памяти, при превышении данного значения используется lowbuffer буфер памяти.
- bigbuffer = 536870912 # не совсем буфер памяти, при превышении данного значения используется medbuffer буфер памяти.

filemode
- **Описание:** Права создания Bolt архивов, файлов и виртуальных атрибутов в бинарном заголовке внутри значений в Bolt архивах.
- **Умолчание:** Обязательный параметр
- **Значения:** 0600-0666
- **Тип:** uint32
- **Секция:** [server.name]

dirmode
- **Описание:** Права создания директорий.
- **Умолчание:** Обязательный параметр
- **Значения:** 0700-0777
- **Тип:** uint32
- **Секция:** [server.name]

delbolt
- **Описание:** Если включено, тогда будет разрешено напрямую удалять Bolt архивы.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

deldir
- **Описание:** Если включено, тогда wZD сервер будет удалять последнюю пустую директорию, при условии, что реально отсутствуют файлы, поддиректории и количество ключей в Bolt архиве = 0. Но удаляется только текущая директория, рекурсивного обхода не реализовано в целях безопасности.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

gzstatic
- **Описание:** Если включено, тогда wZD сервер будет выдавать сжатое содержимое файлов с расширением .gz, если они существуют, при GET запросе не включающим изначально расширение gz. Устанавливает заголовок Content-Encoding: gzip, если клиент присылает Accept-Encoding c типом gzip. Content-Encoding: gzip проставляется даже без включения параметра gzstatic для соответствующих файлов. Для файлов из Bolt архивов логика такая же. Приоритет выдачи gzip файлов.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]

log4xx
- **Описание:** Если включено, тогда wZD сервер будет логировать все запросы с кодами 4XX.
- **Умолчание:** Обязательный параметр
- **Значения:** true или false
- **Тип:** bool
- **Секция:** [server.name]
